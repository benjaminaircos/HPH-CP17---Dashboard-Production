<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPH CP17 - Dashboard Production</title>
    <link rel="stylesheet" href="dashboard-style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“Š HPH CP17 - Dashboard Production</h1>
            <p class="subtitle">Analyse et suivi en temps rÃ©el</p>
            <div class="header-actions">
                <a href="index.html" class="btn btn-secondary">ğŸ“ Retour Ã  la saisie</a>
                <button onclick="chargerDonnees()" class="btn btn-primary">ğŸ”„ Actualiser</button>
            </div>
        </header>

        <!-- Filtres -->
        <div class="filters-section">
            <h2>ğŸ” Filtres</h2>
            <div class="filters-grid">
                <div class="filter-group">
                    <label for="filterDateDebut">ğŸ“… Date DÃ©but :</label>
                    <input type="date" id="filterDateDebut">
                </div>
                <div class="filter-group">
                    <label for="filterDateFin">ğŸ“… Date Fin :</label>
                    <input type="date" id="filterDateFin">
                </div>
                <div class="filter-group">
                    <label for="filterEquipe">ğŸ‘¥ Ã‰quipe :</label>
                    <select id="filterEquipe">
                        <option value="">Toutes les Ã©quipes</option>
                        <option value="Matin">Matin</option>
                        <option value="Soir">Soir</option>
                        <option value="Nuit">Nuit</option>
                    </select>
                </div>
                <div class="filter-group">
                    <button onclick="appliquerFiltres()" class="btn btn-filter">âœ… Appliquer</button>
                    <button onclick="reinitialiserFiltres()" class="btn btn-reset-filter">ğŸ”„ RÃ©initialiser</button>
                </div>
            </div>
        </div>

        <!-- Objectifs -->
        <div class="objectifs-section">
            <h2>ğŸ¯ Objectif de Production</h2>
            <div class="objectifs-grid">
                <div class="objectif-group">
                    <label for="objectifProdEquipe">ğŸ“¦ Objectif Production / Ã‰quipe :</label>
                    <input type="number" id="objectifProdEquipe" value="5000" min="0">
                </div>
                <div class="objectif-group">
                    <label for="objectifTauxRebuts">ğŸ“Š Objectif Taux Rebuts Max (%) :</label>
                    <input type="number" id="objectifTauxRebuts" value="5" min="0" max="100" step="0.1">
                </div>
                <div class="objectif-group">
                    <label for="objectifTRS">ğŸ“ˆ Objectif TRS (%) :</label>
                    <input type="number" id="objectifTRS" value="85" min="0" max="100" step="0.1">
                </div>
                <div class="objectif-group">
                    <label for="cadenceInstantanee">âš™ï¸ Cadence InstantanÃ©e (piÃ¨ces/minute) :</label>
                    <input type="number" id="cadenceInstantanee" value="15" min="0" step="0.1">
                </div>
                <div class="objectif-group">
                    <button onclick="appliquerObjectifs()" class="btn btn-objectif">ğŸ’¾ Enregistrer les Objectifs</button>
                </div>
            </div>
        </div>

        <!-- KPIs -->
        <div class="kpi-section">
            <div class="kpi-card" id="kpiCardProdTotal">
                <div class="kpi-icon">ğŸ“¦</div>
                <div class="kpi-content">
                    <div class="kpi-label">Production Totale</div>
                    <div class="kpi-value" id="kpiProdTotal">0</div>
                    <div class="kpi-objectif" id="kpiObjectifProd"></div>
                    <div class="kpi-status" id="kpiStatusProd"></div>
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon">âœ…</div>
                <div class="kpi-content">
                    <div class="kpi-label">Production Bonne</div>
                    <div class="kpi-value" id="kpiProdBonne">0</div>
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon">âŒ</div>
                <div class="kpi-content">
                    <div class="kpi-label">Rebuts</div>
                    <div class="kpi-value" id="kpiRebuts">0</div>
                </div>
            </div>
            <div class="kpi-card" id="kpiCardTauxRebuts">
                <div class="kpi-icon">ğŸ“Š</div>
                <div class="kpi-content">
                    <div class="kpi-label">Taux de Rebuts</div>
                    <div class="kpi-value" id="kpiTauxRebuts">0%</div>
                    <div class="kpi-objectif" id="kpiObjectifRebuts"></div>
                    <div class="kpi-status" id="kpiStatusRebuts"></div>
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon">â±ï¸</div>
                <div class="kpi-content">
                    <div class="kpi-label">Temps d'ArrÃªt Total</div>
                    <div class="kpi-value" id="kpiTempsArret">0 min</div>
                </div>
            </div>
        </div>

        <!-- Graphiques -->
        <div class="charts-section">
            <div class="chart-container">
                <h3>ğŸ“ˆ Production par Heure</h3>
                <canvas id="chartProductionHeure"></canvas>
            </div>
            <div class="chart-container">
                <h3>ğŸ“Š TRS par Heure <span class="info-icon" title="Formule: TRS = (Prod Bonne + Rebuts) / (Cadence Ã— (60 - ArrÃªts)) Ã— 100
Prod ThÃ©orique = Cadence (piÃ¨ces/min) Ã— Temps productif (60 min - temps d'arrÃªts)">â„¹ï¸</span></h3>
                <canvas id="chartTRS"></canvas>
            </div>
        </div>

        <div class="charts-section">
            <div class="chart-container">
                <h3>ğŸ“Š Production par Ã‰quipe</h3>
                <canvas id="chartProductionEquipe"></canvas>
            </div>
            <div class="chart-container">
                <h3>â±ï¸ DurÃ©e des ArrÃªts par CatÃ©gorie</h3>
                <canvas id="chartDureeArrets"></canvas>
            </div>
        </div>

        <!-- Tableau dÃ©taillÃ© -->
        <div class="table-section">
            <h2>ğŸ“‹ DonnÃ©es DÃ©taillÃ©es</h2>
            <div class="table-controls">
                <button onclick="exporterCSV()" class="btn btn-export">ğŸ’¾ Exporter en CSV</button>
            </div>
            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>RÃ©fÃ©rence</th>
                            <th>Trigramme</th>
                            <th>Ã‰quipe</th>
                            <th>Heure</th>
                            <th>Prod Bonne</th>
                            <th>Rebuts</th>
                            <th>Ã‰quipement</th>
                            <th>DurÃ©e Ã‰quip.</th>
                            <th>QualitÃ©</th>
                            <th>DurÃ©e QualitÃ©</th>
                            <th>Organisation</th>
                            <th>DurÃ©e Org.</th>
                            <th>Autres</th>
                            <th>DurÃ©e Autres</th>
                            <th>Commentaire</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                        <!-- Les donnÃ©es seront insÃ©rÃ©es ici -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Message de chargement -->
        <div id="loadingMessage" class="loading-message">
            <div class="spinner"></div>
            <p>Chargement des donnÃ©es...</p>
        </div>

        <!-- Message d'erreur -->
        <div id="errorMessage" class="error-message" style="display: none;">
            <p>âŒ Erreur lors du chargement des donnÃ©es. Veuillez rÃ©essayer.</p>
        </div>
    </div>

    <script src="dashboard-script.js"></script>
</body>
</html>
